<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Manifest</title>

    <!-- Placeholder for manifest -->
    <script id="manifest-placeholder" type="application/manifest+json">
    {
      "name": "Dynamic App",
      "short_name": "DynApp",
      "start_url": "/",
      "display": "standalone",
      "background_color": "#ffffff",
      "theme_color": "#000000",
      "icons": [
        {
          "src": "icon.svg",
          "sizes": "192x192",
          "type": "image/svg+xml"
        }
      ]
    }
    </script>
</head>
<body>

<h1>Dynamic Manifest and Icon Based on URL</h1>

<script>
    // Function to generate SVG data URI based on hex color
    function createColorSquareSVG(hexColor) {
        return `data:image/svg+xml;base64,${btoa(
            `<svg xmlns="http://www.w3.org/2000/svg" width="192" height="192">
                <rect width="100%" height="100%" fill="${hexColor}" />
             </svg>`
        )}`;
    }

    // Function to update the manifest with a new color
    function updateManifestWithColor(hexColor) {
        const manifestPlaceholder = document.getElementById('manifest-placeholder');
        const manifestContent = JSON.parse(manifestPlaceholder.textContent);

        // Update manifest properties
        manifestContent.theme_color = hexColor;
        manifestContent.icons[0].src = createColorSquareSVG(hexColor);

        // Update the manifest tag with the new content
        manifestPlaceholder.textContent = JSON.stringify(manifestContent);
    }

    // Function to update the title and manifest when the URL hash changes
    function updatePageFromURL() {
        const hash = window.location.hash.slice(1);
        const hexColor = `#${hash}`;

        // Check if the hash is a valid hex color
        if (/^#([0-9A-F]{3}){1,2}$/i.test(hexColor)) {
            // Update the page title with the hex code
            document.title = hexColor;

            // Update the manifest
            updateManifestWithColor(hexColor);
        }
    }

    // Initial load
    updatePageFromURL();

    // Add event listener to detect URL hash changes
    window.addEventListener('hashchange', updatePageFromURL);
</script>

</body>
</html>