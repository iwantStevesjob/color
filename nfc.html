<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web NFC Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
            max-width: 500px;
        }
        button {
            display: block;
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>

    <h1>Web NFC Test</h1>
    <p>Use the buttons below to write or read NFC data using your browser.</p>

    <button id="writeButton">Write to NFC Tag</button>
    <button id="readButton">Read from NFC Tag</button>

    <pre id="output"></pre>

    <script>
        async function writeToNFC() {
            try {
                // Check if NFC is supported
                if ('NDEFWriter' in window) {
                    const nfcWriter = new NDEFWriter();
                    // Write a simple text message to the NFC tag
                    await nfcWriter.write("Hello, peer! Here's the SDP offer.");
                    log("NFC data written successfully.");
                } else {
                    log("NFC is not supported on this browser.");
                }
            } catch (error) {
                log("Error writing to NFC: " + error);
            }
        }

        async function readFromNFC() {
            try {
                // Check if NFC is supported
                if ('NDEFReader' in window) {
                    const nfcReader = new NDEFReader();
                    await nfcReader.scan();
                    nfcReader.onreading = (event) => {
                        const decoder = new TextDecoder();
                        let message = "";
                        for (const record of event.message.records) {
                            message += decoder.decode(record.data) + "\n";
                        }
                        log("Received NFC message:\n" + message);
                    };
                    log("Waiting for NFC data...");
                } else {
                    log("NFC is not supported on this browser.");
                }
            } catch (error) {
                log("Error reading NFC: " + error);
            }
        }

        function log(message) {
            const output = document.getElementById('output');
            output.textContent += message + '\n';
        }

        // Add event listeners to buttons
        document.getElementById('writeButton').addEventListener('click', writeToNFC);
        document.getElementById('readButton').addEventListener('click', readFromNFC);
    </script>

</body>
</html>